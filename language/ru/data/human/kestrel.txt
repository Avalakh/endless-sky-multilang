# Copyright (c) 2014-2015 by Michael Zahniser
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <https://www.gnu.org/licenses/>.

mission "Kestrel Testing"
	name "Испытание военного корабля"
	description "Поездка в систему <waypoints> для борьбы и отключения прототипа военного корабля, который тестирует корпорация Tarazed. Не разрушайте корабль, иначе вы потеряете платеж и возможность его купить."
	source "Wayfarer"
	waypoint "Umbral"
	# The Kestrel is a secret that can only be unlocked after completing the rest of the game. Combat rating is used to track gameplay progression.
	# After finding the Kestrel once, the threshold is lowered so players can use the ship during the human campaign on a later playthrough.
	# Any requests to reduce the requirements will be rejected.
	to offer
		or
			"combat rating" > 6000
			and
				"combat rating" > 2000
				has "global: unlocked kestrel"
	
	on offer
		conversation
			`Когда вы посещаете один из баров космодрома, вас узнает мужчина. "<first> <last>!" - говорит он. "Для меня большая честь познакомиться с вами. Ваши подвиги в бою хорошо известны». Он берет свой напиток и идет, чтобы сесть рядом с вами. «Меня зовут Чарльз Атинода, — говорит он, — главный конструктор звездолетов корпорации Tarazed». Скажите, вы готовы помочь нам испытать новый военный корабль`
			choice
				`"Расскажи мне больше"`
				`«Извините, у меня сейчас нет времени»`
					defer
			`«Ну, — говорит он, — вот история». Семь лет назад, во время глубокого личного кризиса, я оставил свою работу в Таразеде, чтобы побродить по галактике, не имея ничего в своем рюкзаке, кроме смены одежды, столовой с водой и нескольких коробок с аварийным рационом. Анархическая коммуна на одном из окраинных миров приняла меня. После того, как я был там в течение месяца, старейшина деревни, чувствуя мою внутреннюю суматоху, пригласил меня на поиски видения в их потной ложе. Я впал в транс, и мое сознание путешествовало по многим вселенным, где я видел странные вещи. Я видел меч, сделанный из света. Я видел голубое солнце. Я видел... Он делает паузу на мгновение. "...валлийский Корги взломал компьютер? Некоторые из них трудно понять»`
			choice
				`"Удивительно"`
					goto continue
				`Были ли какие-то незаконные вещества вовлечены в этот поиск видения`
			`Он игнорирует ваш вопрос. «Но потом я увидел еще одну вещь», — говорит он.`
				goto kestrel
			label continue
			`«Но потом я увидел еще одну вещь», — говорит он.`
			label kestrel
			`Он долго молчал, а потом говорит: «Я видел темный корабль, более изящный и элегантный, чем любой, который я когда-либо проектировал, сражающийся с инопланетным судном с пестрым красным корпусом. И когда я увидел этот корабль, я понял, что должен построить такой. Я поехал обратно в Wayfarer, умолял вернуть мою старую работу и пошел на работу. Спустя семь лет корабль почти готов. Она прошла все наши неразрушающие испытания с летящими красками, от которых осталось только боевое испытание. И кто лучше сразится с ним, чем знаменитый воин <first> <last>`
			choice
				`"Я был бы рад"`
					goto test
				`Что я получу взамен`
			`«Щедрая оплата, — говорит он, — и право на покупку одного из самых первых агрегатов с производственной линии, если хотите»`
			`"Звучит справедливо", - говорите вы.`
			label test
			`"Отлично", - говорит он. "Мне нужна ваша подпись на нескольких бланках. Отказ от ответственности в случае вашей смерти, разрешение на использование вашего имени и подобия в определенных рекламных материалах. Знаешь, обычные юридические вещи"`
			choice
				`"Нет проблем. Где я буду сражаться с этим кораблем`
				`«Извините, я не думаю, что могу согласиться с этим»`
					decline
			`«Мы проводим большую часть наших испытаний звездолетов в системе <waypoints>», — говорит он. "Испытательный корабль безошибочен. Путешествуйте туда, отключайте его, не разрушая, а затем возвращайтесь сюда, и мы спросим вас о любых найденных вами недостатках или улучшениях, которые вы могли бы сделать. И если вы уничтожите корабль или украдете его, то, естественно, вы потеряете свой платеж»`
				accept
	
	npc disable save
		government "Test Dummy"
		personality disables staying nemesis heroic
		system "Umbral"
		ship "Unknown Ship Type" "Tarazed Prototype"
	
	on complete
		payment 2000000
		"global: unlocked kestrel" ++
		conversation
			`Атинода встречается с тобой вскоре после приземления. «Я вижу, что ты выжил», — говорит он. Это был тяжелый бой`
			choice
				`Да, вы построили впечатляющий корабль`
					goto yes
				`«Нет, боюсь, я сделал короткую работу»`
					goto no
			
			label yes
			`«Рад это слышать», — говорит он. "Теперь у нас есть возможность внести некоторые изменения, прежде чем мы начнем массовое производство этого корабля. Какие изменения вы бы порекомендовали`
				goto changes
			
			label no
			`«В конце концов, — говорит он, — вы печально известный <first> <last>, поэтому я полагаю, что любой отдельный военный корабль будет для вас небольшой угрозой». Теперь у нас есть возможность сделать несколько настроек, прежде чем мы начнем массовое производство этого корабля. Какие изменения вы бы порекомендовали`
				goto changes
			
			label changes
			choice
				`«Много оружия всегда является моим приоритетом»`
					goto weapons
				`Вы должны убедиться, что у него достаточно места для любого двигателя`
					goto engines
				`Возможно, вам стоит поработать над улучшением щитов и корпуса`
					goto shields
				`Я чувствую, что такой большой корабль должен иметь больше бухт для истребителей`
					goto bays
			
			label weapons
			action
				set "kestrel: more weapons"
			`«Очень хорошо, — говорит он, — мы посмотрим, сможем ли мы расширить возможности оружия, чтобы подошло даже самое большое оружие»`
				goto name
			
			label engines
			action
				set "kestrel: more engines"
			`«Очень хорошо, — говорит он, — мы посмотрим, сможем ли мы увеличить мощность двигателя настолько, чтобы подошли даже самые большие двигатели»`
				goto name
			
			label shields
			action
				set "kestrel: more shields"
			`«Хорошо, — говорит он, — мы сосредоточимся на укреплении корпуса и матрицы щита»`
				goto name
			
			label bays
			action
				set "kestrel: more bays"
			`«Очень хорошо, — говорит он, — мы посмотрим, сможем ли мы включить в корпус больше истребителей»`
				goto name
			
			label name
			`«У модели корабля есть имя?» — спросите вы.`
			`"Еще нет", - говорит он. У вас есть предложение`
			choice
				`"Гнев"`
					goto wraith
				`"Серый гусь"`
					goto goose
			
			label wraith
			`«Неплохое имя, — говорит он, — но в Таразе мы обычно называем наши корабли в честь животных». Есть другие идеи`
			choice
				`"Ужасный волк"`
					goto wolf
				`"Кестрель"`
					goto kestrel
			
			label goose
			`«Я полагаю, что это выглядит как гусь в полете, — говорит он, — но вряд ли это пугающее имя». У тебя есть какие-нибудь более страшные идеи`
			choice
				`"Жнец"`
					goto reaper
				`"Кестрель"`
					goto kestrel
			
			label wolf
			`«Неплохо, — говорит он, — но все наши другие корабли — Falcon, Osprey, Hawk — все они птицы». Может, птичье имя`
			choice
				`"Серый гусь"`
					goto goose
				`"Кестрель"`
					goto kestrel
			
			label reaper
			`«Я не знаю, — говорит он, — это звучит немного сверху». Есть другие предложения`
			choice
				`"Гнев"`
					goto wraith
				`"Кестрель"`
					goto kestrel
			
			label kestrel
			`Когда вы произносите слово «Kestrel», он дергается, как будто его только что ударили током. «Да, — говорит он, — вот и все!» Это имя, с которым мы пойдем. Спасибо, капитан. Я сообщу вам, как только Kestrel будет доступен для продажи, и мы будем учитывать ваши рекомендации при внесении наших окончательных изменений в дизайн». Он платит вам два миллиона кредитов и желает вам удачи в ваших будущих начинаниях.`



mission "Kestrel: More Weapons"
	landing
	invisible
	non-blocking
	to offer
		has "kestrel: more weapons"
	on offer
		event "kestrel available: more weapons" 50
		fail



mission "Kestrel: More Engines"
	landing
	invisible
	non-blocking
	to offer
		has "kestrel: more engines"
	on offer
		event "kestrel available: more engines" 50
		fail



mission "Kestrel: More Shields"
	landing
	invisible
	non-blocking
	to offer
		has "kestrel: more shields"
	on offer
		event "kestrel available: more shields" 50
		fail



mission "Kestrel: More Bays"
	landing
	invisible
	non-blocking
	to offer
		has "kestrel: more bays"
	on offer
		event "kestrel available: more bays" 50
		fail



mission "Kestrel Available"
	landing
	source
		near "Tarazed" 100
	to offer
		has "kestrel available"
	destination "Wayfarer"
	on offer
		conversation
			branch engines
				has "kestrel: more engines"
			
			branch shields
				has "kestrel: more shields"
			
			branch bays
				has "kestrel: more bays"
			
			scene "thumbnail/kestrelw"
			``
				goto message
			
			label engines
			scene "thumbnail/kestrele"
			``
				goto message
			
			label shields
			scene "thumbnail/kestrels"
			``
				goto message
				
			label bays
			scene "thumbnail/kestrelc"
			``
			label message
			`Вы получаете сообщение от Чарльза Атиноды, проектировщика корабля в корпорации Tarazed: «Капитан <last>, мы рады сообщить вам, что наш последний военный корабль теперь доступен для продажи здесь, на Wayfarer. Мы учли все ваши отзывы в окончательном дизайне. Еще раз спасибо`
				decline


shipyard "Kestrel"

event "kestrel available: more weapons"
	set "kestrel available"
	shipyard "Kestrel"
		"Kestrel (More Weapons)"
	planet Wayfarer
		add shipyard "Kestrel"
event "kestrel available: more engines"
	set "kestrel available"
	shipyard "Kestrel"
		"Kestrel (More Engines)"
	planet Wayfarer
		add shipyard "Kestrel"
event "kestrel available: more shields"
	set "kestrel available"
	shipyard "Kestrel"
		"Kestrel (More Shields)"
	planet Wayfarer
		add shipyard "Kestrel"
event "kestrel available: more bays"
	set "kestrel available"
	shipyard "Kestrel"
		"Kestrel (More Bays)"
	planet Wayfarer
		add shipyard "Kestrel"


ship "Unknown Ship Type"
	sprite "ship/kestrel"
	thumbnail "thumbnail/kestrel"
	attributes
		category "Heavy Warship"
		"cost" 14700000
		"shields" 19400
		"hull" 7200
		"required crew" 64
		"bunks" 128
		"mass" 2135
		"drag" 20.9
		"heat dissipation" .32
		"fuel capacity" 500
		"cargo space" 120
		"outfit space" 810
		"weapon capacity" 390
		"engine capacity" 210
		weapon
			"blast radius" 260
			"shield damage" 2600
			"hull damage" 1300
			"hit force" 3900
	outfits
		"Particle Cannon" 4
		"Torpedo Launcher" 2
		"Torpedo" 60
		"Heavy Laser Turret" 4
		
		"Fusion Reactor"
		"LP144a Battery Pack"
		"D94-YV Shield Generator"
		"Liquid Nitrogen Cooler"
		"Tactical Scanner" 2
		
		"Orca Plasma Thruster"
		"Orca Plasma Steering"
		"Hyperdrive"
	engine 13 170
	engine -13 170
	gun -73.5 46 "Torpedo Launcher"
	gun 73.5 46 "Torpedo Launcher"
	gun -51 49.5 "Particle Cannon"
	gun 51 49.5 "Particle Cannon"
	gun -29.5 52 "Particle Cannon"
	gun 29.5 52 "Particle Cannon"
	turret -8 -10.5 "Heavy Laser Turret"
	turret 8 -10.5 "Heavy Laser Turret"
	turret -20.5 9 "Heavy Laser Turret"
	turret 20.5 9 "Heavy Laser Turret"
	explode "small explosion" 25
	explode "medium explosion" 35
	explode "large explosion" 45
	explode "huge explosion" 30
	"final explode" "final explosion large"


ship "Kestrel"
	sprite "ship/kestrel"
	thumbnail "thumbnail/kestrel"
	attributes
		category "Heavy Warship"
		"cost" 14700000
		"shields" 19400
		"hull" 7200
		"required crew" 64
		"bunks" 128
		"mass" 2135
		"drag" 20.9
		"heat dissipation" .32
		"fuel capacity" 500
		"cargo space" 120
		"outfit space" 810
		"weapon capacity" 390
		"engine capacity" 210
		weapon
			"blast radius" 260
			"shield damage" 2600
			"hull damage" 1300
			"hit force" 3900
	outfits
		"Particle Cannon" 4
		"Torpedo Launcher" 2
		"Torpedo" 60
		"Heavy Laser Turret" 4
		
		"Fusion Reactor"
		"LP144a Battery Pack"
		"D94-YV Shield Generator"
		"Liquid Nitrogen Cooler"
		"Tactical Scanner" 2
		
		"Orca Plasma Thruster"
		"Orca Plasma Steering"
		"Hyperdrive"
	engine 13 170
	engine -13 170
	gun -73.5 46 "Torpedo Launcher"
	gun 73.5 46 "Torpedo Launcher"
	gun -51 49.5 "Particle Cannon"
	gun 51 49.5 "Particle Cannon"
	gun -29.5 52 "Particle Cannon"
	gun 29.5 52 "Particle Cannon"
	turret -8 -10.5 "Heavy Laser Turret"
	turret 8 -10.5 "Heavy Laser Turret"
	turret -20.5 9 "Heavy Laser Turret"
	turret 20.5 9 "Heavy Laser Turret"
	bay "Fighter" -46 106 under
		"launch effect" "human internal"
	bay "Fighter" 46 106 under
		"launch effect" "human internal"
	explode "small explosion" 25
	explode "medium explosion" 35
	explode "large explosion" 45
	explode "huge explosion" 30
	"final explode" "final explosion large"
	description "Несколько лет назад, посещая потный домик в поисках духовного обновления, главный конструктор корабля Таразеда впал в транс и отправился в реальность, отдельную от нашей. Там он увидел видения странного и элегантного звездолета. Возвращаясь к своей работе с новой целью, он провел следующие семь лет, делая Кестрел реальностью."


ship "Kestrel" "Kestrel (More Engines)"
	sprite "ship/kestrele"
	thumbnail "thumbnail/kestrele"
	add attributes
		"drag" -1.9
		"fuel capacity" 100
		"engine capacity" 30
	engine 13 170
	engine -13 170
	engine 24.5 160 0.4
	engine -24.5 160 0.4

ship "Kestrel" "Kestrel (More Shields)"
	sprite "ship/kestrels"
	thumbnail "thumbnail/kestrels"
	add attributes
		"shields" 3000
		"hull" 1500
		"heat dissipation" .032

ship "Kestrel" "Kestrel (More Weapons)"
	sprite "ship/kestrelw"
	thumbnail "thumbnail/kestrelw"
	add attributes
		"weapon capacity" 40
	gun -76.5 49
	gun 76.5 49
	gun -73.5 46 "Torpedo Launcher"
	gun 73.5 46 "Torpedo Launcher"
	gun -55.5 52.5
	gun 55.5 52.5
	gun -51 49.5 "Particle Cannon"
	gun 51 49.5 "Particle Cannon"
	gun -33 55
	gun 33 55
	gun -29.5 52 "Particle Cannon"
	gun 29.5 52 "Particle Cannon"
	turret -8 -10.5 "Heavy Laser Turret"
	turret 8 -10.5 "Heavy Laser Turret"
	turret -20.5 9 "Heavy Laser Turret"
	turret 20.5 9 "Heavy Laser Turret"

ship "Kestrel" "Kestrel (More Bays)"
	sprite "ship/kestrelc"
	thumbnail "thumbnail/kestrelc"
	add attributes
		"mass" 60
		"weapon capacity" -20
	outfits
		"Particle Cannon" 2
		"Torpedo Launcher" 2
		"Torpedo" 60
		"Heavy Laser Turret" 4
		
		"Fusion Reactor"
		"LP144a Battery Pack"
		"D94-YV Shield Generator"
		"Liquid Nitrogen Cooler"
		"Tactical Scanner" 2
		
		"Orca Plasma Thruster"
		"Orca Plasma Steering"
		"Hyperdrive"
	gun -73.5 46 "Torpedo Launcher"
	gun 73.5 46 "Torpedo Launcher"
	gun -29.5 52 "Particle Cannon"
	gun 29.5 52 "Particle Cannon"
	turret -8 -10.5 "Heavy Laser Turret"
	turret 8 -10.5 "Heavy Laser Turret"
	turret -20.5 9 "Heavy Laser Turret"
	turret 20.5 9 "Heavy Laser Turret"
	bay "Fighter" -46 106
		"launch effect" "human internal"
	bay "Fighter" 46 106
		"launch effect" "human internal"
	bay "Fighter" -62 78
		"launch effect" "human internal"
	bay "Fighter" 62 78
		"launch effect" "human internal"
	bay "Fighter" -56 70
		"launch effect" "human internal"
	bay "Fighter" 56 70
		"launch effect" "human internal"
